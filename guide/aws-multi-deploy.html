<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>AWS 다중 서버 배포 | DevOps 안내서</title>
    <meta name="description" content="Vue.js - The Progressive JavaScript Framework2">
    <link rel="stylesheet" href="/devops/assets/style.3f799ee4.css">
    <link rel="modulepreload" href="/devops/assets/app.7bd26314.js">
    <link rel="modulepreload" href="/devops/assets/guide_aws-multi-deploy.md.8ae5c812.lean.js">
    <link rel="prefetch" href="/devops/assets/chunks/VPAlgoliaSearchBox.670435ce.js">
    <script>(()=>{const e=localStorage.getItem("vue-theme-appearance");(!e||e==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  <link rel="icon" type="image/png" sizes="32x32" href="/devops/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/devops/icons/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/devops/icons/apple-touch-icon.png">
  <link rel="manifest" href="/devops/manifest.json">
  <link rel="mask-icon" href="/devops/icons/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="msapplication-TileImage" content="/devops/icons/mstile-150x150.png">
  <meta name="msapplication-TileColor" content="#000000">
  <script src="https://distinct-protected.subicura.dev/script.js" data-site="AIERDXCX" data-spa="auto" defer=""></script>
  <meta name="og:image" content="https://subicura.com/devops/imgs/share.png">
  <meta name="og:type" content="website">
  <meta name="og:site_name" content="쿠버네티스 안내서">
  <meta name="twitter:image" content="https://subicura.com/devops/imgs/share.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:creator" content="@subicura">
  <meta name="twitter:site" content="@subicura">
  <meta property="og:description" content="AWS 다중 서버 배포 하기">
  <meta property="twitter:description" content="AWS 다중 서버 배포 하기">
  <meta name="twitter:title" content="AWS 다중 서버 배포 | DevOps 안내서">
  <meta property="og:title" content="AWS 다중 서버 배포 | DevOps 안내서">
  </head>
  <body>
    <div id="app"><div class="VPApp" data-v-f158032c><!--[--><span tabindex="-1" data-v-cf07e2da></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-cf07e2da> Skip to content </a><!--]--><!----><!--[--><!--]--><header class="VPNav nav-bar" data-v-f158032c data-v-3fbfa027><div class="VPNavBar" data-v-3fbfa027 data-v-39f04925><div class="container" data-v-39f04925><a class="VPNavBarTitle" href="/devops/" data-v-39f04925 data-v-a75ea40e><img class="logo" src="/devops/icons/apple-touch-icon.png" data-v-a75ea40e><span class="text" data-v-a75ea40e>DevOps 안내서</span></a><div class="content" data-v-39f04925><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-39f04925 data-v-7b95ab7d><span id="main-nav-aria-label" class="visually-hidden" data-v-7b95ab7d>Main Navigation</span><!--[--><!--[--><a class="vt-link link VPNavBarMenuLink active" href="/devops/guide/hello.html" data-v-7b95ab7d data-v-1478fa39><!--[-->📔 가이드<!--]--><!----></a><!--]--><!--[--><a class="vt-link link VPNavBarMenuLink" href="/devops/wait/coming-soon.html" data-v-7b95ab7d data-v-1478fa39><!--[-->📺 영상강의<!--]--><!----></a><!--]--><!--[--><a class="vt-link link VPNavBarMenuLink" href="https://subicura.com?utm_source=subicura.com&amp;utm_medium=referral&amp;utm_campaign=devops" target="_blank" rel="noopener noreferrer" data-v-7b95ab7d data-v-1478fa39><!--[-->👨‍💻 블로그<!--]--><!----></a><!--]--><!--]--></nav><div class="VPNavBarAppearance appearance" data-v-39f04925 data-v-0bc8dbd8><button class="vt-switch vt-switch-appearance" type="button" role="switch" aria-label="toggle dark mode" data-v-0bc8dbd8><span class="vt-switch-check"><span class="vt-switch-icon"><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="vt-switch-appearance-sun"><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="vt-switch-appearance-moon"><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="vt-social-links VPNavBarSocialLinks social-links" data-v-39f04925 data-v-5d8f6d79><!--[--><a class="vt-social-link is-small" href="https://github.com/subicura/devops/" title="github" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="vt-social-link-icon"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg><span class="visually-hidden">github</span></a><a class="vt-social-link is-small" href="https://twitter.com/subicura" title="twitter" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="vt-social-link-icon"><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"></path></svg><span class="visually-hidden">twitter</span></a><a class="vt-social-link is-small" href="https://subicura.com" title="blog" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="vt-social-link-icon"><path d="M12,1C5.9,1,1,5.9,1,12s4.9,11,11,11s11-4.9,11-11S18.1,1,12,1z M20.9,11h-4c-0.2-2.8-1.1-5.4-2.7-7.7C17.8,4.2,20.5,7.3,20.9,11zM9.1,13h5.9c-0.3,2.7-1.3,5.3-2.9,7.4C10.3,18.3,9.3,15.7,9.1,13zM9.1,11c0.3-2.7,1.3-5.3,2.9-7.4c1.7,2.2,2.7,4.8,2.9,7.4H9.1z M9.7,3.3C8.2,5.6,7.3,8.2,7.1,11h-4C3.5,7.3,6.2,4.2,9.7,3.3zM3.1,13h4c0.2,2.8,1.1,5.4,2.7,7.7C6.2,19.8,3.5,16.7,3.1,13z M14.3,20.7c1.5-2.3,2.4-4.9,2.7-7.7h4C20.5,16.7,17.8,19.8,14.3,20.7z"></path></svg><span class="visually-hidden">blog</span></a><!--]--></div><div class="vt-flyout VPNavBarExtra extra" ref_key="elRef" data-v-39f04925 data-v-309ded52><button type="button" class="vt-flyout-button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="vt-flyout-button-icon"><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="vt-flyout-menu"><div class="vt-menu"><!----><!--[--><!--[--><div class="vt-menu-group" data-v-309ded52><div class="vt-menu-item item" data-v-309ded52><p class="vt-menu-label" data-v-309ded52>Appearance</p><div class="vt-menu-action action" data-v-309ded52><button class="vt-switch vt-switch-appearance" type="button" role="switch" aria-label="toggle dark mode" data-v-309ded52><span class="vt-switch-check"><span class="vt-switch-icon"><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="vt-switch-appearance-sun"><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="vt-switch-appearance-moon"><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="vt-menu-group" data-v-309ded52><div class="vt-menu-item item" data-v-309ded52><div class="vt-social-links social-links" data-v-309ded52><!--[--><a class="vt-social-link is-small" href="https://github.com/subicura/devops/" title="github" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="vt-social-link-icon"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg><span class="visually-hidden">github</span></a><a class="vt-social-link is-small" href="https://twitter.com/subicura" title="twitter" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="vt-social-link-icon"><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"></path></svg><span class="visually-hidden">twitter</span></a><a class="vt-social-link is-small" href="https://subicura.com" title="blog" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="vt-social-link-icon"><path d="M12,1C5.9,1,1,5.9,1,12s4.9,11,11,11s11-4.9,11-11S18.1,1,12,1z M20.9,11h-4c-0.2-2.8-1.1-5.4-2.7-7.7C17.8,4.2,20.5,7.3,20.9,11zM9.1,13h5.9c-0.3,2.7-1.3,5.3-2.9,7.4C10.3,18.3,9.3,15.7,9.1,13zM9.1,11c0.3-2.7,1.3-5.3,2.9-7.4c1.7,2.2,2.7,4.8,2.9,7.4H9.1z M9.7,3.3C8.2,5.6,7.3,8.2,7.1,11h-4C3.5,7.3,6.2,4.2,9.7,3.3zM3.1,13h4c0.2,2.8,1.1,5.4,2.7,7.7C6.2,19.8,3.5,16.7,3.1,13z M14.3,20.7c1.5-2.3,2.4-4.9,2.7-7.7h4C20.5,16.7,17.8,19.8,14.3,20.7z"></path></svg><span class="visually-hidden">blog</span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><button type="button" class="vt-hamburger VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-39f04925 data-v-23c0b27d><span class="vt-hamburger-container"><span class="vt-hamburger-top"></span><span class="vt-hamburger-middle"></span><span class="vt-hamburger-bottom"></span></span></button></div></div></div><!----></header><div class="VPLocalNav" data-v-f158032c data-v-597a6fe2><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-597a6fe2><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-597a6fe2><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-597a6fe2>Menu</span></button><a class="top-link" href="#" data-v-597a6fe2>Return to top</a></div><aside ref_key="navEl" class="VPSidebar" data-v-f158032c data-v-1da41fc7><nav id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-1da41fc7><!--[--><!--]--><span id="sidebar-aria-label" class="visually-hidden" data-v-1da41fc7>Sidebar Navigation</span><!--[--><div class="group" data-v-1da41fc7><section class="VPSidebarGroup" data-v-1da41fc7 data-v-0ba6a09b><div class="title" data-v-0ba6a09b><h2 class="title-text" data-v-0ba6a09b>들어가기</h2></div><!--[--><a class="link" href="/devops/guide/hello.html" data-v-0ba6a09b data-v-f80d76a4><p class="link-text" data-v-f80d76a4>DevOps 도입하기</p></a><!--]--></section></div><div class="group" data-v-1da41fc7><section class="VPSidebarGroup" data-v-1da41fc7 data-v-0ba6a09b><div class="title" data-v-0ba6a09b><h2 class="title-text" data-v-0ba6a09b>개발과 테스트 코드</h2></div><!--[--><a class="link" href="/devops/guide/web.html" data-v-0ba6a09b data-v-f80d76a4><p class="link-text" data-v-f80d76a4>Node.js 웹 애플리케이션</p></a><a class="link" href="/devops/guide/git.html" data-v-0ba6a09b data-v-f80d76a4><p class="link-text" data-v-f80d76a4>Git</p></a><a class="link" href="/devops/guide/github.html" data-v-0ba6a09b data-v-f80d76a4><p class="link-text" data-v-f80d76a4>GitHub</p></a><a class="link" href="/devops/guide/validate.html" data-v-0ba6a09b data-v-f80d76a4><p class="link-text" data-v-f80d76a4>Validate, 테스트 자동화</p></a><!--]--></section></div><div class="group" data-v-1da41fc7><section class="VPSidebarGroup" data-v-1da41fc7 data-v-0ba6a09b><div class="title" data-v-0ba6a09b><h2 class="title-text" data-v-0ba6a09b>배포</h2></div><!--[--><a class="link" href="/devops/guide/deploy.html" data-v-0ba6a09b data-v-f80d76a4><p class="link-text" data-v-f80d76a4>배포하기</p></a><a class="link" href="/devops/guide/aws-deploy.html" data-v-0ba6a09b data-v-f80d76a4><p class="link-text" data-v-f80d76a4>AWS 배포</p></a><a class="link active" href="/devops/guide/aws-multi-deploy.html" data-v-0ba6a09b data-v-f80d76a4><p class="link-text" data-v-f80d76a4>AWS 다중 서버 배포</p></a><a class="link" href="/devops/guide/aws-domain.html" data-v-0ba6a09b data-v-f80d76a4><p class="link-text" data-v-f80d76a4>도메인 연결하기</p></a><!--]--></section></div><div class="group" data-v-1da41fc7><section class="VPSidebarGroup" data-v-1da41fc7 data-v-0ba6a09b><div class="title" data-v-0ba6a09b><h2 class="title-text" data-v-0ba6a09b>컨테이너 (준비중)</h2></div><!--[--><a class="link" href="/devops/guide/docker.html" data-v-0ba6a09b data-v-f80d76a4><p class="link-text" data-v-f80d76a4>Docker</p></a><!--]--></section></div><div class="group" data-v-1da41fc7><section class="VPSidebarGroup" data-v-1da41fc7 data-v-0ba6a09b><div class="title" data-v-0ba6a09b><h2 class="title-text" data-v-0ba6a09b>지속적 통합(CI) (준비중)</h2></div><!--[--><a class="link" href="/devops/guide/jenkins.html" data-v-0ba6a09b data-v-f80d76a4><p class="link-text" data-v-f80d76a4>Jenkins</p></a><a class="link" href="/devops/guide/jenkins-report.html" data-v-0ba6a09b data-v-f80d76a4><p class="link-text" data-v-f80d76a4>Lint, 테스트, 커버리지</p></a><a class="link" href="/devops/guide/jenkins-github.html" data-v-0ba6a09b data-v-f80d76a4><p class="link-text" data-v-f80d76a4>Jenkins + GitHub</p></a><!--]--></section></div><div class="group" data-v-1da41fc7><section class="VPSidebarGroup" data-v-1da41fc7 data-v-0ba6a09b><div class="title" data-v-0ba6a09b><h2 class="title-text" data-v-0ba6a09b>쿠버네티스 (준비중)</h2></div><!--[--><a class="link" href="/devops/guide/kubernetes.html" data-v-0ba6a09b data-v-f80d76a4><p class="link-text" data-v-f80d76a4>Kubernetes</p></a><a class="link" href="/devops/guide/helm.html" data-v-0ba6a09b data-v-f80d76a4><p class="link-text" data-v-f80d76a4>Helm</p></a><a class="link" href="/devops/guide/gitops.html" data-v-0ba6a09b data-v-f80d76a4><p class="link-text" data-v-f80d76a4>GitOps</p></a><a class="link" href="/devops/guide/autoscaling.html" data-v-0ba6a09b data-v-f80d76a4><p class="link-text" data-v-f80d76a4>Cluster AutoScaling</p></a><a class="link" href="/devops/guide/jenkins-gitops.html" data-v-0ba6a09b data-v-f80d76a4><p class="link-text" data-v-f80d76a4>Jenkins + GitOps</p></a><a class="link" href="/devops/guide/monitoring.html" data-v-0ba6a09b data-v-f80d76a4><p class="link-text" data-v-f80d76a4>모니터링</p></a><a class="link" href="/devops/guide/alert.html" data-v-0ba6a09b data-v-f80d76a4><p class="link-text" data-v-f80d76a4>모니터링 알림</p></a><!--]--></section></div><!--]--><!--[--><!--]--></nav></aside><div id="VPContent" class="VPContent has-sidebar" data-v-f158032c data-v-23d1a30e><div class="VPContentDoc has-aside has-sidebar" data-v-23d1a30e data-v-65e0225b><div class="container" data-v-65e0225b><div class="aside" data-v-65e0225b><div class="aside-container" data-v-65e0225b><!--[--><!--]--><div class="VPContentDocOutline" ref_key="container" data-v-65e0225b data-v-cc02a67a><div class="outline-marker" data-v-cc02a67a></div><div class="outline-title" data-v-cc02a67a>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-cc02a67a><span id="doc-outline-aria-label" class="visually-hidden" data-v-cc02a67a>Table of Contents for current page</span><ul class="root" data-v-cc02a67a><!--[--><li style="" data-v-cc02a67a><a class="outline-link" href="#aws-vpc" data-v-cc02a67a>AWS VPC</a><!----></li><li style="" data-v-cc02a67a><a class="outline-link" href="#aws-cli" data-v-cc02a67a>AWS CLI</a><!----></li><li style="" data-v-cc02a67a><a class="outline-link" href="#프라이빗-서브넷-만들기" data-v-cc02a67a>프라이빗 서브넷 만들기</a><!----></li><li style="" data-v-cc02a67a><a class="outline-link" href="#ec2-여러개-만들기" data-v-cc02a67a>EC2 여러개 만들기</a><!----></li><li style="" data-v-cc02a67a><a class="outline-link" href="#elastic-load-balancer-만들기" data-v-cc02a67a>Elastic Load Balancer 만들기</a><!----></li><li style="" data-v-cc02a67a><a class="outline-link" href="#마무리" data-v-cc02a67a>마무리</a><!----></li><!--]--></ul></nav></div><!--[--><!--]--><!----><!--[--><!--]--></div></div><div class="content" data-v-65e0225b><!--[--><!--]--><main data-v-65e0225b><div style="position:relative;" class="vt-doc guide" data-v-65e0225b><div><h1 id="aws-다중-서버-배포" tabindex="-1">AWS 다중 서버 배포 <a class="header-anchor" href="#aws-다중-서버-배포" aria-hidden="true">#</a></h1><div class="tip custom-block"><p class="custom-block-title">⚡️ 목표</p><p>✅ AWS VPC에 대해 알아봅니다.<br> ✅ AWS CLI 사용법을 알아봅니다.<br> ✅ 프라이빗 서브넷을 생성합니다.<br> ✅ ALB를 생성합니다.</p></div><p><div class="table-of-contents"><ul><li><a href="#aws-vpc">AWS VPC</a></li><li><a href="#aws-cli">AWS CLI</a></li><li><a href="#프라이빗-서브넷-만들기">프라이빗 서브넷 만들기</a></li><li><a href="#ec2-여러개-만들기">EC2 여러개 만들기</a></li><li><a href="#elastic-load-balancer-만들기">Elastic Load Balancer 만들기</a></li><li><a href="#마무리">마무리</a></li></ul></div></p><p><code>Awesome API</code> 서비스는 점점 인기가 많아졌고 더 이상 <code>t2.micro</code> 한 대로 버티긴 어려울 것 같습니다. CPU 성능을 높이는 스케일 업<sup>Scale Up</sup> 방식도 생각했지만, 부하에 따라 서버의 개수를 유연하게 조정할 수 있는 스케일 아웃<sup>Scale Out</sup> 방식으로 결정했습니다.</p><div class="kakao-room" data-v-1b648e20><!--[--><div class="kakao-msg" data-v-401f7b72><div class="msg-wrapper" data-v-401f7b72><div class="avatar" style="background: url(&#39;/devops/build/imgs/senior.png&#39;) no-repeat center center; background-size: cover;" data-v-401f7b72></div><div class="msg-info" data-v-401f7b72><div class="user" data-v-401f7b72>촋 CTO</div><div class="msg" data-v-401f7b72>이번엔 서버를 프라이빗 서브넷에 구축해 볼게요</div></div><div class="msg-empty" data-v-401f7b72></div></div></div><div class="kakao-msg is-me" data-v-401f7b72><div class="msg-wrapper" data-v-401f7b72><div class="avatar" style="visibility: hidden;" data-v-401f7b72></div><div class="msg-info" data-v-401f7b72><div class="user" data-v-401f7b72></div><div class="msg" data-v-401f7b72>퍼블릭 서브넷하고 프라이빗 서브넷 차이가 뭔가요??</div></div><div class="msg-empty" data-v-401f7b72></div></div></div><div class="kakao-msg" data-v-401f7b72><div class="msg-wrapper" data-v-401f7b72><div class="avatar" style="background: url(&#39;/devops/build/imgs/senior.png&#39;) no-repeat center center; background-size: cover;" data-v-401f7b72></div><div class="msg-info" data-v-401f7b72><div class="user" data-v-401f7b72>촋 CTO</div><div class="msg" data-v-401f7b72>퍼블릭 서브넷은 인터넷에 노출된 영역이고 프라이빗 서브넷은 인터넷과 분리된 내부망 영역이라고 보시면 돼요</div></div><div class="msg-empty" data-v-401f7b72></div></div></div><div class="kakao-msg is-me" data-v-401f7b72><div class="msg-wrapper" data-v-401f7b72><div class="avatar" style="visibility: hidden;" data-v-401f7b72></div><div class="msg-info" data-v-401f7b72><div class="user" data-v-401f7b72></div><div class="msg" data-v-401f7b72>근데.. 인터넷이랑 분리되어 있으면 어떻게 접근하나요??</div></div><div class="msg-empty" data-v-401f7b72></div></div></div><div class="kakao-msg" data-v-401f7b72><div class="msg-wrapper" data-v-401f7b72><div class="avatar" style="background: url(&#39;/devops/build/imgs/senior.png&#39;) no-repeat center center; background-size: cover;" data-v-401f7b72></div><div class="msg-info" data-v-401f7b72><div class="user" data-v-401f7b72>촋 CTO</div><div class="msg" data-v-401f7b72>퍼블릭 서브넷에 로드 밸런서랑 NAT 게이트웨이를 둘 거에요. 그럼 프라이빗 네트워크에 있는 서버가 외부랑 통신할 수 있어요</div></div><div class="msg-empty" data-v-401f7b72></div></div></div><div class="kakao-msg is-me" data-v-401f7b72><div class="msg-wrapper" data-v-401f7b72><div class="avatar" style="visibility: hidden;" data-v-401f7b72></div><div class="msg-info" data-v-401f7b72><div class="user" data-v-401f7b72></div><div class="msg" data-v-401f7b72>아! 그럼 외부에서 접근할 땐 로드 밸런서를 통해서 접근하고 내부에서 인터넷 통신이 필요할 땐 NAT 게이트웨이를 거치는 거군요??</div></div><div class="msg-empty" data-v-401f7b72></div></div></div><div class="kakao-msg" data-v-401f7b72><div class="msg-wrapper" data-v-401f7b72><div class="avatar" style="background: url(&#39;/devops/build/imgs/senior.png&#39;) no-repeat center center; background-size: cover;" data-v-401f7b72></div><div class="msg-info" data-v-401f7b72><div class="user" data-v-401f7b72>촋 CTO</div><div class="msg" data-v-401f7b72>네네 맞아요. 직접적인 서버 접근이 불가능하기 때문에 보안 측면에서 유리해요</div></div><div class="msg-empty" data-v-401f7b72></div></div></div><div class="kakao-msg" data-v-401f7b72><div class="msg-wrapper" data-v-401f7b72><div class="avatar" style="visibility: hidden;" data-v-401f7b72></div><div class="msg-info" data-v-401f7b72><div class="user" data-v-401f7b72></div><div class="msg" data-v-401f7b72>네트워크 구성이 쪼옴 어려울 수 있는데 일단 만들면서 알아볼게요</div></div><div class="msg-empty" data-v-401f7b72></div></div></div><!--]--></div><h2 id="aws-vpc" tabindex="-1">AWS VPC <a class="header-anchor" href="#aws-vpc" aria-hidden="true">#</a></h2><p>VPC(Virtual Private Cloud)는 AWS에서 제공하는 강력한 <s>복잡한</s> 가상 네트워크 환경입니다.</p><p>서울(ap-northeast-2), 도쿄(ap-northeast-1), N. Virginia(us-east-1)등 각 지역<sup>region</sup>마다 VPC가 있고 서울은 4개의 가용영역<sup>Availability Zone</sup>(A,B,C,D)이 있습니다. 처음 AWS 계정을 생성하면 <a href="https://docs.aws.amazon.com/ko_kr/vpc/latest/userguide/default-vpc.html" target="_blank" rel="noopener noreferrer">가용영역별로 하나씩 퍼블릭 서브넷</a>을 만들어 주는데, 원하는 만큼 서브넷을 추가할 수 있고 프라이빗 서브넷을 추가하여 보안을 강화할 수 있습니다.</p><p>그냥 적당히 설정하고 쓰면 안 될까 싶지만, 인터넷에서 바로 접근할 수 있는 퍼블릭 서브넷에 서버를 배치하는 건 위험하고, 비좁은 서브넷에 서버를 배치하다 보면 나중에 IP가 부족할 수도 있습니다. <s>EKS 맛좀 보면..</s> 추후 VPC간 연결이나 VPN 사용을 고려하여 네트워크 대역을 변경할 필요도 있습니다.</p><p>일단 기본 설정을 유지하고 프라이빗 서브넷을 추가합니다. 서울 리전(ap-northeast-2) 가용영역 중 A와 C에 <code>172.31.112.0/20</code>, <code>172.31.144.0/20</code> 영역으로 생성하겠습니다.</p><div class="image-500"><picture><source srcset="/devops/build/imgs/aws-multi-deploy/vpc-subnet.webp" type="image/webp"><source srcset="/devops/build/imgs/aws-multi-deploy/vpc-subnet.png" type="image/png"><img src="/devops/build/imgs/aws-multi-deploy/vpc-subnet.png" alt="Public Subnet" loading="lazy"></picture></div><div class="tip custom-block"><p class="custom-block-title">CIDR(Classless Inter-Domain Routing)</p><p><a href="https://ko.wikipedia.org/wiki/%EC%82%AC%EC%9D%B4%EB%8D%94_(%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%82%B9)" target="_blank" rel="noopener noreferrer">CIDR(사이더)</a>는 IP 주소를 할당하고 패킷을 라우팅하는 방식 중 하나입니다. 서버는 IP 주소(<a href="http://xxx.xxx.xxx.xxx" target="_blank" rel="noopener noreferrer">xxx.xxx.xxx.xxx</a>)로 통신을 하는데 하나하나 경로를 지정하면 복잡하기 때문에 앞에 주소를 고정하고 뒤에 주소만 다르게 하여 블록 단위로 경로를 관리합니다.<br> CIDR 블록은 <code>xxx.xxx.xxx.xxx(아이피)/xx(고정 비트 수)</code>와 같이 표기하며 영역이 서로 겹치지 않게 잘 관리해야 합니다.</p></div><div class="tip custom-block"><p class="custom-block-title">AWS VPC 더보기</p><p>📔 <a href="https://docs.aws.amazon.com/ko_kr/vpc/latest/userguide/what-is-amazon-vpc.html" target="_blank" rel="noopener noreferrer">Amazon VPC란 무엇인가?</a></p></div><h2 id="aws-cli" tabindex="-1">AWS CLI <a class="header-anchor" href="#aws-cli" aria-hidden="true">#</a></h2><p>서브넷은 AWS 관리자 화면에서 클릭클릭으로 만들 수 있지만, 이번엔 AWS CLI<sup>Command Line Interface</sup>를 이용합니다. AWS는 <s>거의</s> 모든 걸 CLI로 빠르고 간편하게 만들 수 있습니다.</p><ol><li>Access Key를 만들기 위해 Security Credentials 메뉴를 선택합니다.</li></ol><div class="image-250"><picture><source srcset="/devops/build/imgs/aws-multi-deploy/security-credentials.webp" type="image/webp"><source srcset="/devops/build/imgs/aws-multi-deploy/security-credentials.png" type="image/png"><img src="/devops/build/imgs/aws-multi-deploy/security-credentials.png" alt="Security Credentials" loading="lazy"></picture></div><ol start="2"><li>Access Keys 항목에서 <code>Create New Access Key</code>를 누릅니다.</li></ol><div class="image-800"><picture><source srcset="/devops/build/imgs/aws-multi-deploy/accesskey.webp" type="image/webp"><source srcset="/devops/build/imgs/aws-multi-deploy/accesskey.png" type="image/png"><img src="/devops/build/imgs/aws-multi-deploy/accesskey.png" alt="Access Key" loading="lazy"></picture></div><ol start="3"><li>Access Key ID와 Secret Access Key를 확인할 수 있습니다.</li></ol><div class="image-550"><picture><source srcset="/devops/build/imgs/aws-multi-deploy/accesskey-create.webp" type="image/webp"><source srcset="/devops/build/imgs/aws-multi-deploy/accesskey-create.png" type="image/png"><img src="/devops/build/imgs/aws-multi-deploy/accesskey-create.png" alt="Access Key Created" loading="lazy"></picture></div><div class="warning custom-block"><p class="custom-block-title">주의!!</p><p>Access Key ID와 Secret Access Key는 <strong>무지무지무지 중요한 정보</strong>입니다. 이 키만 있으면 AWS의 모든 리소스를 만들 수 있기 때문에 혹시나 유출되면 순식간에 채굴 서버가 생성되는 무시무시한 경험을 할 수 있습니다. 수백, 수천만원이 청구되길 원치 않는다면 키를 반드시 안전하게 보관하고 실습이 끝나고 필요하지 않은 키는 삭제하는 것이 좋습니다.</p></div><p><a href="https://docs.aws.amazon.com/ko_kr/cli/latest/userguide/getting-started-install.html" target="_blank" rel="noopener noreferrer">awscli를 설치하고</a> Access Key를 설정합니다.</p><div class="language-sh"><pre><code><span class="line"><span style="color:#A6ACCD;">aws configure</span></span>
<span class="line"></span></code></pre></div><div class="language-sh"><pre><code><span class="line"><span style="color:#A6ACCD;">AWS Access Key ID </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">None</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;">: AKIA61234567890ABCDE</span></span>
<span class="line"><span style="color:#A6ACCD;">AWS Secret Access Key </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">None</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;">: thisissecretdonotusethis</span></span>
<span class="line"><span style="color:#A6ACCD;">Default region name </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">None</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;">: ap-northeast-2</span></span>
<span class="line"><span style="color:#A6ACCD;">Default output format </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">None</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;">:</span></span>
<span class="line"></span></code></pre></div><p>설정을 완료하고 계정 정보를 확인합니다.</p><div class="language-sh"><pre><code><span class="line"><span style="color:#A6ACCD;">aws sts get-caller-identity</span></span>
<span class="line"></span></code></pre></div><div class="language-json"><pre><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">UserId</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">AIDAI1234567890ABCDEF</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">Account</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1234567890AB</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">Arn</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">arn:aws:iam::1234567890AB:user/subicura</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>준비가 완료되었으니, 한 땀 한 땀 리소스를 생성하고 연결해 보겠습니다.</p><div class="tip custom-block"><p class="custom-block-title">cli_pager 옵션</p><p>AWS CLI의 실행 결과를 화면에 그대로 출력하려면 다음 명령어를 입력합니다.<br><code>aws configure set cli_pager &quot;&quot;</code></p></div><div class="tip custom-block"><p class="custom-block-title">AWS CLI 더보기</p><p>📔 <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-welcome.html" target="_blank" rel="noopener noreferrer">AWS CLI 소개</a><br> 📝 <a href="https://github.com/99designs/aws-vault" target="_blank" rel="noopener noreferrer">AWS Vault</a></p></div><h2 id="프라이빗-서브넷-만들기" tabindex="-1">프라이빗 서브넷 만들기 <a class="header-anchor" href="#프라이빗-서브넷-만들기" aria-hidden="true">#</a></h2><div class="image-550"><picture><source srcset="/devops/build/imgs/aws-multi-deploy/vpc-private-subnet.webp" type="image/webp"><source srcset="/devops/build/imgs/aws-multi-deploy/vpc-private-subnet.png" type="image/png"><img src="/devops/build/imgs/aws-multi-deploy/vpc-private-subnet.png" alt="Public Subnet" loading="lazy"></picture></div><p>프라이빗 서브넷을 만들기 위해선 다음 리소스가 필요합니다.</p><ul><li>서브넷</li><li>NAT 게이트웨이 (+ 공인 IP / Elastic IP)</li><li>라우팅 테이블</li></ul><ol><li>A 가용영역에 서브넷을 생성합니다.<br> 서브넷이 퍼블릭 서브넷인지 프라이빗 서브넷인지는 연결된 라우팅 테이블에 따라 결정됩니다. 라우팅 테이블에 설정된 경로가 인터넷 게이트웨이를 바라보면 퍼블릭 서브넷, 그렇지 않으면 프라이빗 서브넷입니다.<br> 기본 라우팅 테이블은 인터넷 게이트웨이를 바라보므로 새로 만들어야 합니다.</li></ol><div class="language-sh"><pre><code><span class="line"><span style="color:#A6ACCD;">aws ec2 create-subnet --vpc-id </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">vpc-id</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> --cidr-block 172.31.112.0/20 --availability-zone=ap-northeast-2a</span></span>
<span class="line"></span></code></pre></div><blockquote><ul><li><code>vpc-id</code>: 서브넷을 생성할 VPC ID를 입력합니다. VPC 메뉴에서 확인하거나 <code>aws ec2 describe-vpcs --query &#39;Vpcs[*].VpcId&#39;</code> 명령어를 이용합니다.</li><li><code>availability-zone</code>: 가용영역을 입력합니다. 서울 지역의 A 가용영역인 <code>ap-northeast-2a</code>를 입력합니다.</li></ul></blockquote><ol start="2"><li>NAT 게이트웨이에 할당할 공인 IP를 생성합니다.</li></ol><div class="language-sh"><pre><code><span class="line"><span style="color:#A6ACCD;">aws ec2 allocate-address --domain vpc</span></span>
<span class="line"></span></code></pre></div><ol start="3"><li>프라이빗 서브넷이 인터넷에 연결할 수 있도록 NAT 게이트웨이를 생성합니다.</li></ol><div class="language-sh"><pre><code><span class="line"><span style="color:#A6ACCD;">aws ec2 create-nat-gateway --subnet-id </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">public-subnet-id</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> --allocation-id </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">elastic-ip-address-id</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><blockquote><ul><li><code>subnet-id</code>: NAT 게이트웨이가 위치할 서브넷 ID를 입력합니다. A 가용영역에 있는 Public Subnet ID를 선택합니다. VPC &gt; Subnets 메뉴에서 확인하거나 <code>aws ec2 describe-subnets --query &#39;Subnets[*].[SubnetId, AvailabilityZone, CidrBlock]&#39;</code> 명령어를 이용합니다.</li><li><code>allocation-id</code>: 위에서 생성한 Elastic IP 정보를 입력합니다.</li></ul></blockquote><ol start="4"><li>프라이빗 서브넷에 연결할 라우팅 테이블을 만듭니다.</li></ol><div class="language-sh"><pre><code><span class="line"><span style="color:#A6ACCD;">aws ec2 create-route-table --vpc-id </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">vpc-id</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><ol start="5"><li>생성한 라우팅 테이블에 경로를 추가합니다.</li></ol><div class="language-sh"><pre><code><span class="line"><span style="color:#A6ACCD;">aws ec2 create-route --route-table-id </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">route-table-id</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> --destination-cidr-block 0.0.0.0/0 --gateway-id </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">nat-gateway-id</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><blockquote><ul><li><code>route-table-id</code>: 위에서 생성한 라우팅 테이블 ID를 입력합니다.</li><li><code>destination-cidr-block</code>: 내부망을 제외한 모든 요청을 NAT 게이트웨이로 보내기 위해 &#39;0.0.0.0/0&#39;을 입력합니다.</li><li><code>gateway-id</code>: 위에서 생성한 NAT 게이트웨이 ID를 입력합니다.</li></ul></blockquote><ol start="6"><li>완성된 라우팅 테이블을 서브넷에 연결합니다.</li></ol><div class="language-sh"><pre><code><span class="line"><span style="color:#A6ACCD;">aws ec2 associate-route-table --route-table-id </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">route-table-id</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> --subnet-id </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">private-subnet-id</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><blockquote><ul><li><code>route-table-id</code>: 위에서 생성한 라우팅 테이블 ID를 입력합니다.</li><li><code>subnet-id</code>: 위에서 생성한 서브넷 ID를 입력합니다.</li></ul></blockquote><p>🎉 조금(?) 복잡했지만 프라이빗 서브넷을 생성했습니다! 위 내용을 참고하여 C 가용영역에 하나 더 만듭니다. <s>숙제</s></p><h2 id="ec2-여러개-만들기" tabindex="-1">EC2 여러개 만들기 <a class="header-anchor" href="#ec2-여러개-만들기" aria-hidden="true">#</a></h2><p>지난번에 배포했던 방식은 다음과 같습니다.</p><div class="image-550"><picture><source srcset="/devops/build/imgs/aws-multi-deploy/vpc-public.webp" type="image/webp"><source srcset="/devops/build/imgs/aws-multi-deploy/vpc-public.png" type="image/png"><img src="/devops/build/imgs/aws-multi-deploy/vpc-public.png" alt="Public Subnet" loading="lazy"></picture></div><p>퍼블릭 서브넷에 EC2를 배치하고 바로 요청을 처리하는 방식입니다. 방화벽을 설정했지만, 왠지 불안한 구성입니다.</p><div class="image-550"><picture><source srcset="/devops/build/imgs/aws-multi-deploy/vpc-private.webp" type="image/webp"><source srcset="/devops/build/imgs/aws-multi-deploy/vpc-private.png" type="image/png"><img src="/devops/build/imgs/aws-multi-deploy/vpc-private.png" alt="Public / Private Subnet" loading="lazy"></picture></div><p>이번에 구성할 방식은 프라이빗 서브넷에 EC2 2대를 배치하고 Load Balancer를 통해 요청을 처리합니다. 프라이빗 서브넷에 배치해서 안전하고 Load Balancer를 통해 여러 대의 서버에 요청을 할 수 있습니다.</p><p><a href="./aws-deploy.html#ec2-만들기">지난번</a>에 만들었던 방법과 비슷하게 EC2를 2대 생성합니다. 차이점은 Subnet, Auto-assign public IP, Security Group 입니다.</p><p><strong>Subnet</strong> <code>Private 영역 선택</code></p><ul><li>앞에서 생성한 프라이빗 서브넷을 선택합니다.</li></ul><div class="image-600"><picture><source srcset="/devops/build/imgs/aws-multi-deploy/ec2-private-subnet.webp" type="image/webp"><source srcset="/devops/build/imgs/aws-multi-deploy/ec2-private-subnet.png" type="image/png"><img src="/devops/build/imgs/aws-multi-deploy/ec2-private-subnet.png" alt="EC2 - Subnet" loading="lazy"></picture></div><p><strong>Auto-assign public IP</strong> <code>Disable</code></p><ul><li>외부에 노출하지 않는 서버이므로 공인 아이피를 할당하지 않습니다.</li></ul><div class="image-600"><picture><source srcset="/devops/build/imgs/aws-multi-deploy/ec2-private-ip.webp" type="image/webp"><source srcset="/devops/build/imgs/aws-multi-deploy/ec2-private-ip.png" type="image/png"><img src="/devops/build/imgs/aws-multi-deploy/ec2-private-ip.png" alt="EC2 - Public IP" loading="lazy"></picture></div><p><strong>Security Group</strong> <code>3000 포트를 전체(0.0.0.0/0) 허용</code></p><ul><li>Load Balancer가 80 포트로 요청을 받으면 뒤에 있는 서버는 꼭 80 포트가 아니여도 괜찮습니다. 기존 애플리케이션 설정인 3000 포트를 사용합니다.</li></ul><div class="image-650"><picture><source srcset="/devops/build/imgs/aws-multi-deploy/ec2-private-sg.webp" type="image/webp"><source srcset="/devops/build/imgs/aws-multi-deploy/ec2-private-sg.png" type="image/png"><img src="/devops/build/imgs/aws-multi-deploy/ec2-private-sg.png" alt="EC2 - Security Group" loading="lazy"></picture></div><p><strong>Number of instances</strong> <code>2</code></p><ul><li>동일한 설정으로 여러 대의 서버를 생성합니다.</li></ul><div class="image-350"><picture><source srcset="/devops/build/imgs/aws-multi-deploy/ec2-number.webp" type="image/webp"><source srcset="/devops/build/imgs/aws-multi-deploy/ec2-number.png" type="image/png"><img src="/devops/build/imgs/aws-multi-deploy/ec2-number.png" alt="EC2 - Number of instances" loading="lazy"></picture></div><p>서버가 생성되면, <a href="./aws-deploy.html#node-js-배포">지난번과 동일</a>하게 서버에 접속하여 애플리케이션을 배포합니다. 3000포트 그대로 서비스하므로 iptables 설정은 제외해도 됩니다.</p><h2 id="elastic-load-balancer-만들기" tabindex="-1">Elastic Load Balancer 만들기 <a class="header-anchor" href="#elastic-load-balancer-만들기" aria-hidden="true">#</a></h2><p>로드 밸런서는 부하를 적절하게 분산해주는 장치입니다. 기본적인 동작 방식은 사용자가 로드 밸런서에 요청을 보내면 로드 밸런서가 여러대의 서버 중 한대에 요청을 전달하고, 서버가 응답한 결과를 다시 사용자에게 전달해줍니다.</p><div class="kakao-room" data-v-1b648e20><!--[--><div class="kakao-msg is-me" data-v-401f7b72><div class="msg-wrapper" data-v-401f7b72><div class="avatar" style="visibility: hidden;" data-v-401f7b72></div><div class="msg-info" data-v-401f7b72><div class="user" data-v-401f7b72></div><div class="msg" data-v-401f7b72>지난번엔 서버 IP로 바로 요청을 보냈는데, 이젠 로드 밸런서로 요청을 해야 하나요?</div></div><div class="msg-empty" data-v-401f7b72></div></div></div><div class="kakao-msg" data-v-401f7b72><div class="msg-wrapper" data-v-401f7b72><div class="avatar" style="background: url(&#39;/devops/build/imgs/senior.png&#39;) no-repeat center center; background-size: cover;" data-v-401f7b72></div><div class="msg-info" data-v-401f7b72><div class="user" data-v-401f7b72>촋 CTO</div><div class="msg" data-v-401f7b72>네네 로드 밸런서로 요청을 보내면 연결된 서버로 부하를 분산해 줍니다</div></div><div class="msg-empty" data-v-401f7b72></div></div></div><div class="kakao-msg is-me" data-v-401f7b72><div class="msg-wrapper" data-v-401f7b72><div class="avatar" style="visibility: hidden;" data-v-401f7b72></div><div class="msg-info" data-v-401f7b72><div class="user" data-v-401f7b72></div><div class="msg" data-v-401f7b72>근데.. 혹시 로드 밸런서가 죽으면 어떻게 되나요??</div></div><div class="msg-empty" data-v-401f7b72></div></div></div><div class="kakao-msg" data-v-401f7b72><div class="msg-wrapper" data-v-401f7b72><div class="avatar" style="background: url(&#39;/devops/build/imgs/senior.png&#39;) no-repeat center center; background-size: cover;" data-v-401f7b72></div><div class="msg-info" data-v-401f7b72><div class="user" data-v-401f7b72>촋 CTO</div><div class="msg" data-v-401f7b72>로드 밸런서가 죽으면 아무리 서버가 많아도 서비스가 멈추겠죠??</div></div><div class="msg-empty" data-v-401f7b72></div></div></div><div class="kakao-msg is-me" data-v-401f7b72><div class="msg-wrapper" data-v-401f7b72><div class="avatar" style="visibility: hidden;" data-v-401f7b72></div><div class="msg-info" data-v-401f7b72><div class="user" data-v-401f7b72></div><div class="msg" data-v-401f7b72>헉??!! 그럼.. 로드 밸런서를 안 죽게 그 앞에 또 로드 밸런서를 두나요..?</div></div><div class="msg-empty" data-v-401f7b72></div></div></div><div class="kakao-msg is-me" data-v-401f7b72><div class="msg-wrapper" data-v-401f7b72><div class="avatar" style="visibility: hidden;" data-v-401f7b72></div><div class="msg-info" data-v-401f7b72><div class="user" data-v-401f7b72></div><div class="msg" data-v-401f7b72>그리고 부하가 진짜 많으면 로드 밸런서도 죽을 수 있는 거 아닌가요?</div></div><div class="msg-empty" data-v-401f7b72></div></div></div><div class="kakao-msg" data-v-401f7b72><div class="msg-wrapper" data-v-401f7b72><div class="avatar" style="background: url(&#39;/devops/build/imgs/senior.png&#39;) no-repeat center center; background-size: cover;" data-v-401f7b72></div><div class="msg-info" data-v-401f7b72><div class="user" data-v-401f7b72>촋 CTO</div><div class="msg" data-v-401f7b72>ㅎㅎ 맞아요. 로드 밸런서도 죽을 수 있기 때문에 대비가 필요해요</div></div><div class="msg-empty" data-v-401f7b72></div></div></div><div class="kakao-msg" data-v-401f7b72><div class="msg-wrapper" data-v-401f7b72><div class="avatar" style="visibility: hidden;" data-v-401f7b72></div><div class="msg-info" data-v-401f7b72><div class="user" data-v-401f7b72></div><div class="msg" data-v-401f7b72>그 고민을 해결해주는 서비스가 Elastic Load Balancer에요. Elastic Load Balancer는 둘 이상의 가용 영역에서 설치해서 안정성을 높이고 트래픽에 따라 자동으로 성능을 확장해줍니다</div></div><div class="msg-empty" data-v-401f7b72></div></div></div><!--]--></div><p>Elastic Load Balancer는 Application Load Balancers, Network Load Balancers, Gateway Load Balancers, Classic Load Balancer 총 4가지 로드 밸런서를 제공하는데 여기선 ALB(Application Load Balancers)를 사용합니다. HTTP 통신을 할 때 가장 많이 사용하는 로드 밸런서입니다.</p><p>EC2 &gt; Load Balancers 메뉴에서 새로운 로드 밸런서를 추가합니다.</p><ol><li>여러 종류 중에 ALB를 선택합니다.</li></ol><div class="image-700"><picture><source srcset="/devops/build/imgs/aws-multi-deploy/create-lb.webp" type="image/webp"><source srcset="/devops/build/imgs/aws-multi-deploy/create-lb.png" type="image/png"><img src="/devops/build/imgs/aws-multi-deploy/create-lb.png" alt="ELB - Type" loading="lazy"></picture></div><ol start="2"><li>이름을 입력하고 Scheme와 IP address type은 기본값을 선택합니다. 내부망에서 사용하는 경우 Internal을 선택할 수 있습니다.</li></ol><div class="image-700"><picture><source srcset="/devops/build/imgs/aws-multi-deploy/elb-basic-config.webp" type="image/webp"><source srcset="/devops/build/imgs/aws-multi-deploy/elb-basic-config.png" type="image/png"><img src="/devops/build/imgs/aws-multi-deploy/elb-basic-config.png" alt="ELB - Basic Configuration" loading="lazy"></picture></div><ol start="3"><li>로드 밸런서를 배치할 서브넷을 선택합니다. 로드 밸런서는 인터넷 요청을 받아야 하므로 퍼블릭 서브넷에 배치하고 안정성을 위해 2개 이상의 가용 영역을 선택합니다.</li></ol><div class="image-700"><picture><source srcset="/devops/build/imgs/aws-multi-deploy/elb-network.webp" type="image/webp"><source srcset="/devops/build/imgs/aws-multi-deploy/elb-network.png" type="image/png"><img src="/devops/build/imgs/aws-multi-deploy/elb-network.png" alt="ELB - Network Mapping" loading="lazy"></picture></div><ol start="4"><li>HTTP(80)를 허용하는 Security Group을 만듭니다.</li></ol><div class="image-700"><picture><source srcset="/devops/build/imgs/aws-multi-deploy/elb-sg.webp" type="image/webp"><source srcset="/devops/build/imgs/aws-multi-deploy/elb-sg.png" type="image/png"><img src="/devops/build/imgs/aws-multi-deploy/elb-sg.png" alt="ELB - Security Group" loading="lazy"></picture></div><ol start="5"><li>로드 밸런서 HTTP(80) 요청을 전달할 Target Group을 생성합니다. 대부분 기본 설정을 그대로 사용하고 Port를 80에서 3000으로 변경합니다.</li></ol><div class="image-250"><picture><source srcset="/devops/build/imgs/aws-multi-deploy/target-group-port.webp" type="image/webp"><source srcset="/devops/build/imgs/aws-multi-deploy/target-group-port.png" type="image/png"><img src="/devops/build/imgs/aws-multi-deploy/target-group-port.png" alt="Target Group - Port" loading="lazy"></picture></div><blockquote><p>대상 인스턴스는 이전에 만든 EC2를 선택하고 <code>Include as pending below</code>를 선택합니다.</p></blockquote><div class="image-700"><picture><source srcset="/devops/build/imgs/aws-multi-deploy/target-group-regist.webp" type="image/webp"><source srcset="/devops/build/imgs/aws-multi-deploy/target-group-regist.png" type="image/png"><img src="/devops/build/imgs/aws-multi-deploy/target-group-regist.png" alt="Target Group - Regist" loading="lazy"></picture></div><ol start="6"><li>생성한 Target Group을 선택합니다.</li></ol><div class="image-700"><picture><source srcset="/devops/build/imgs/aws-multi-deploy/elb-target.webp" type="image/webp"><source srcset="/devops/build/imgs/aws-multi-deploy/elb-target.png" type="image/png"><img src="/devops/build/imgs/aws-multi-deploy/elb-target.png" alt="ELB - Target Group" loading="lazy"></picture></div><p>최종적으로 ALB가 생성되면, DNS name으로 접근하여 테스트합니다.</p><p>🎉성공! 정상적으로 응답을 확인했습니다. 이제 서버 한 대에 문제가 생겨도 서비스는 정상 작동하고 부하가 생겨도 손쉽게 확장할 수 있습니다.</p><div class="tip custom-block"><p class="custom-block-title">Elastic Load Balancing 더보기</p><p>📔 <a href="https://aws.amazon.com/ko/elasticloadbalancing/" target="_blank" rel="noopener noreferrer">Elastic Load Balancing 소개</a><br> 📔 <a href="https://docs.aws.amazon.com/ko_kr/elasticloadbalancing/latest/application/introduction.html" target="_blank" rel="noopener noreferrer">Application Load Balancer 알아보기</a></p></div><h2 id="마무리" tabindex="-1">마무리 <a class="header-anchor" href="#마무리" aria-hidden="true">#</a></h2><p>가장 일반적인 배포 방식을 알아보았습니다. 서비스마다 세부적인 차이는 있지만, 큰 틀은 동일하다고 보시면 됩니다.</p><p>Elastic Beanstalk도 EC2를 만들고, Target Group에 등록하고 ELB를 연결하는 동일한 방식을 사용합니다. 배포방식을 <code>All at once</code>에서 <code>Rolling with additional batch</code>로 변경하면, 배포할 때 새로운 EC2를 하나 더 만들고 애플리케이션을 배포한 다음 Target Group을 새로운 EC2를 바라보게 변경하고 이전 EC2를 제거하는 과정을 자동으로 해줍니다. 순간적으로 인스턴스가 2대 생기기 때문에 서비스가 중단되지 않겠죠?</p><p>그럼 도메인을 연결하고 HTTPS 보안을 적용하는 방법을 알아보겠습니다.</p></div></div><p class="edit-link" data-v-65e0225b><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke="currentColor" class="vt-icon" data-v-65e0225b><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg><a class="vt-link link" href="https://github.com/subicura/devops/edit/main/src/guide/aws-multi-deploy.md" target="_blank" rel="noopener noreferrer" data-v-65e0225b><!--[-->Edit this page on GitHub<!--]--><!----></a></p></main><!--[--><!--[--><!--[--><div ref_key="comment" class="ut-comment-wrapper" data-v-b73b366c></div><!--]--><!--]--><!--]--><footer class="VPContentDocFooter" data-v-65e0225b data-v-151d54ed><a class="prev-link" href="/devops/guide/aws-deploy.html" data-v-151d54ed><span class="desc" data-v-151d54ed><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="vt-link-icon" data-v-151d54ed><path d="M15,19c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4l6-6c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4L10.4,12l5.3,5.3c0.4,0.4,0.4,1,0,1.4C15.5,18.9,15.3,19,15,19z"></path></svg> Previous</span><span class="title" data-v-151d54ed>AWS 배포</span></a><a class="next-link" href="/devops/guide/aws-domain.html" data-v-151d54ed><span class="desc" data-v-151d54ed>Next <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="vt-link-icon" data-v-151d54ed><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></span><span class="title" data-v-151d54ed>도메인 연결하기</span></a></footer></div></div></div></div><div class="visually-hidden" aria-live="polite" data-v-f158032c>AWS 다중 서버 배포 has loaded</div></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"guide_alert.md\":\"1276b606\",\"guide_autoscaling.md\":\"653d92d9\",\"guide_aws-deploy.md\":\"5715f95f\",\"guide_aws-domain.md\":\"532d118e\",\"guide_aws-multi-deploy.md\":\"8ae5c812\",\"guide_deploy.md\":\"89c8c0c8\",\"guide_docker.md\":\"3b003d79\",\"guide_git.md\":\"dbe6e584\",\"guide_github.md\":\"08056642\",\"guide_gitops.md\":\"31ced0ca\",\"guide_hello.md\":\"a43d0b68\",\"guide_helm.md\":\"2d95d98b\",\"guide_jenkins-github.md\":\"ddded834\",\"guide_jenkins-gitops.md\":\"3747b658\",\"guide_jenkins-report.md\":\"31da3c47\",\"guide_jenkins.md\":\"f2d1c22d\",\"guide_kubernetes.md\":\"bed7e327\",\"guide_monitoring.md\":\"511dc313\",\"guide_test.md\":\"3936ecad\",\"guide_validate.md\":\"6684cb8e\",\"guide_web.md\":\"b40a270a\",\"index.md\":\"67ef8599\",\"wait_coming-soon.md\":\"7940a5fe\"}")</script>
    <script type="module" async src="/devops/assets/app.7bd26314.js"></script>
    
  </body>
</html>